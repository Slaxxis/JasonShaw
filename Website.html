<!DOCTYPE html>
<html>
<head>
    <title>Particle Display</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <h1>Particle Display</h1>
    
    <canvas id="canvas" width="500" height="500"></canvas>
    <br>
    <button id="startButton">Start</button>
    <input type="color" id="colorPicker" value="#ff0000">

    <script>
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");
        var particles = [];
        var requestId;
        var color = document.getElementById("colorPicker").value;

        function Particle(x, y, color) {
            this.x = x;
            this.y = y;
            this.color = color;
            this.vx = Math.random() * 2 - 1;
            this.vy = Math.random() * 2 - 1;
        }

        Particle.prototype.draw = function() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, 5, 0, Math.PI * 2, false);
            ctx.fillStyle = this.color;
            ctx.fill();
        };

        function createParticle(event) {
            var rect = canvas.getBoundingClientRect();
            var x = event.clientX - rect.left;
            var y = event.clientY - rect.top;
            var particle = new Particle(x, y, color);
            particles.push(particle);
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            for (var i = 0; i < particles.length; i++) {
                var particle = particles[i];
                particle.x += particle.vx;
                particle.y += particle.vy;
                particle.draw();

                if (particle.x < 0 || particle.x > canvas.width || particle.y < 0 || particle.y > canvas.height) {
                    particles.splice(i, 1);
                    i--;
                }
            }

            requestId = requestAnimationFrame(animate);
        }

        function startAnimation() {
            requestId = requestAnimationFrame(animate);
        }

        function stopAnimation() {
            cancelAnimationFrame(requestId);
        }

        function updateColor() {
            color = document.getElementById("colorPicker").value;
        }

        canvas.addEventListener("mousedown", createParticle);
        document.getElementById("startButton").addEventListener("click", startAnimation);
        document.getElementById("colorPicker").addEventListener("input", updateColor);
    </script>
</body>
</html>
